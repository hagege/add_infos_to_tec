Todo:

Fertigstellung 1.01:
Dateien kopieren:
1. add_shortcode_to_tec.php
2. readme.txt



in readme.txt:

= [0.8] 2019-05-12 =
* New feature: The name of the buttons can now be defined via the settings.

= 1.1 =
* Icon added to the editor tinycme, so that now the entries for the internal and external link no longer only have to be entered manually directly as short code, but via an additional dialog.

screenshot mit dem ICON




13052019.3.
  Shortcode als Gutenberg Block umwandeln, siehe hier:
      https://www.affordablewebsiteorlando.com/learn-convert-shortcodes-gutenberg-blocks-wordpress-developers/

13052019.4.
  Problem: Wenn - aus welchen Gründen auch immer - jemand die Bezeichnung der Kategorie ändert,
      wird logischerweise der Shortcode nicht automatisch geändert.
      Das könnte z. B. eine Option für eine PRO-VERSION sein.

13052019.6.
  Übersetzungen (Lokalisieren) bei JS-Dateien
      https://codex.wordpress.org/Function_Reference/wp_localize_script
      https://pascalbirchler.com/internationalization-in-wordpress-5-0/
      https://bueltge.de/daten-aus-wordpress-an-javascript-uebergeben-2/1334/
      https://make.wordpress.org/core/2018/11/09/new-javascript-i18n-support-in-wordpress/
      https://www.smashingmagazine.com/2018/01/internationalize-your-wordpress-website/

13052019.12.
  Bei Seiten, die keinen events calendar haben, sollte eine (in dem Fall) unsinnige Option "vl" abgefangen werden

14052019.1.
  https bzw. http automatisch ergänzen, wenn das fehlt - siehe auch entsprechende Vorbereitungen in 1.1  (ait_buttons.js)

29052019.1.
  3 Felder für eigene Nutzung - das können spezielle Links auf Veranstaltungskategorien sein oder abe allgemeine LINKS
  siehe Zeile 173:
  if ( $werte[$ait_shortcode_wert1] != 'nein' ) {
    $fs_ausgabe = $fs_ausgabe . '<p class="fuss_button-absatz"><a class="fuss_button-beitrag" href=' . $ait_pfad_wert1 . ' ' . target="_blank">'. $ait_label_wert1 . '</a></p>';
  }
  $ait_shortcode_wert1    enthält die Bezeichnung für das Feld, z. B. 'fm'
  $ait_pfad_wert1         enthält den kompletten Pfad, z. B. 'https://aachenerkinder.de/veranstaltungen/kategorie/flohmarkt/Karte/'
  $ait_label_wert1        enthält die Bezeichnung die im Button zu sehen ist

  d. h. es kommen insgesamt 9 Felder in den Einstellungen dazu. Daher ist es sinnvoll, die Einstellungen auf zwei tabs zu verteilen:
  a) Gestaltung: mit Farben, etc.
  b) Bezeichnung: mit allen Bezeichnungen, Pfaden und Shortcodebeschriftungen
  siehe hier:
  https://scottdeluzio.com/create-tabbed-settings-pages-for-wordpress-plugins/
  http://qnimate.com/wordpress-settings-api-a-comprehensive-developers-guide/

  Hinweis in der readme.txt: Bei den zusätzlichen Feldern sollten später keine Änderungen bei der Bezeichnung der Shortcodes vorgenommen werden,
    weil es ansonsten zu Problemen kommt und die Shortcodes nicht mehr korrekt dargestellt werden









Erledigt:
28052019.1.
Fehler in der Console sichtbar:
  Uncaught ReferenceError: tinymce is not defined
    at ait_buttons-72a1ea84aa4b27a0928cbb0a24a3ceb3.js:1
    at ait_buttons-72a1ea84aa4b27a0928cbb0a24a3ceb3.js:9
    lag an dem Aufruf der Übersetzungsfunktion (siehe Ende), jetzt zunächst mal auskommentiert.

1. Da es wegen der Schreibweise zu Problemen kommen kann, sollte der slug durch die Funktion cliff_get_events_taxonomies(), siehe Zeile 226
    übergeben werden
    siehe dazu auch https://codex.wordpress.org/Function_Reference/wp_dropdown_categories
      value_field (string) (optional) Term field that should be used to populate the 'value' attribute of the option elements.
      Accepts any valid term field: 'term_id', 'name', 'slug', 'term_group', 'term_taxonomy_id', 'taxonomy', 'description', 'parent', 'count'.
      Default: term_id
      Da gibt es auch Beispiele für Dropdown-Listen, die für die Übergabe bei der Shortcode-Erstellung genutzt werden können
    Beispiel: Wenn slug = "sport" ist, aber die Kategorie "Sport" heißt
    "slug" shon übergeben, aber dann stimmt der Vergleich nicht mehr, d. h. hier müsste das noch zusätzlich umgewandelt werden (z. B. alles in Kleinbuchstaben)

2. Erweitern des plugins um "ferien" und "kfm" für aachenerkinder.de, sowie "fm" für aachen50plus.de
   Abhängig vom der URL sollen Einstellungen für aachen50plus.de und aachenerkinder.de aktiviert werden, evtl. aber auch so drin lassen ohne Prüfung
        Am Anfang:
        $additional_options = false;
        // Wenn der Pfad "aachen" enthält:
        if stripos(path_for_tec(), 'aachen'){
          $additional_options = true;
        }

        Dann ab Zeile 123:
        'kfm' => 'nein',
        'ferien' => 'nein',

        Dann ab Zeile 181:
        if $additional_options === true {
          if ( $werte['fm'] != 'nein' ) {
            $fs_ausgabe = $fs_ausgabe . '<p class="fuss_button-absatz"><a class="fuss_button-beitrag" href=' . $ait_pfad . 'flohmarkt target="_blank">' . 'Weitere Flohmärkte' . '</a></p>';
          }
          if ( $werte['kfm'] != 'nein' ) {
            $fs_ausgabe = $fs_ausgabe . '<p class="fuss_button-absatz"><a class="fuss_button-beitrag" href=' . $ait_pfad . 'flohmarkt target="_blank">' . 'Weitere Kinderflohmärkte' . '</a></p>';
          }
          if ( $werte['ferien'] != 'nein' ) {
            $fs_ausgabe = $fs_ausgabe . '<p class="fuss_button-absatz"><a class="fuss_button-beitrag" href=' . $ait_pfad . 'ferien target="_blank">' . 'Weitere Ferienangebote' . '</a></p>';
          }
        }



5. Bei Nutzung des Icons sollte bei Leerlassen des Internen Link nicht il="" ausgegeben werden. Auch mal für externen Link prüfen
    ==> funktioniert einwandfrei, weil das in dem Fall einfach ignoriert wird.

8. Der Ordner für TEC muss geprüft werden, weil ansonsten die Einstellungen nicht funktionieren, evtl. über
    plugin_dir_url o. ä.

9. Hinweis, wenn TEC nicht installiert ist.

10. Versionsanzeige (Konstante AIT_VERSION)

11. Bezeichnungen für die Buttons in den Einstellungen
    Problem ist die Sprachdatei. Klären, wie das upgedatet wird.

13. auf der lokalen Seite aachenerkinder.de muss unbedingt der Shortcode aus der functions.php entfernt werden, sonst funktioniert das plugin nicht.
    Daher auf das parent theme umgestellt.






Zurückgestellt:

0. Nonces
    wichtig:
    <form method="post" action="options-general.php?page=add_infos_to_tec_settings_page">
    damit man wieder auf die Einstellungsseite kommt. Dann wird allerdings nichts gespeichert


    unklar, wo das eingebaut werden muss, siehe Anleitung auf Seite 87:
    if (! isset( $_POST['_wpnonce'] )	|| ! wp_verify_nonce( $_POST['_wpnonce'],	'kommt_von_A' )) {
        print 'Sorry, Nonce ist nicht korrekt.';
        exit;
    } else {
      // Weiter im Programm
    }

    Wenn das in die function add_infos_to_tec_create_menu() eingebaut wird, dann erfolgt zumindest eine Reaktion, allerdings wenig erwünscht, d. h.
    hier ist die richtige Stelle für die Abfrage !!!!
    Aber offenbar kommt da die Variable 'ait_tec' nicht an
    /*
    if (! isset( $_POST['ait_tec'] )	|| ! wp_verify_nonce( $_POST['ait_tec'],	'plugin_settings_link' )) {
        print 'Sorry, Nonce ist nicht korrekt.';
        exit;
    }
    */
